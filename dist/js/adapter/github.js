!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.AssetPickerAdapterGithub=t()}}(function(){return function t(e,n,i){function o(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(t){var n=e[a][1][t];return o(n?n:t)},h,h.exports,t,e,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){e.exports={translations:{description:{en:"Repository {{config.username}}/{{config.repository}} on GitHub",de:"Repository {{config.username}}/{{config.repository}} auf GitHub"}},http:{base:"https://api.github.com"},data:function(){return{token:null}},created:function(){this.token=this.appConfig.github.token||localStorage.getItem("github_token")},watch:{token:function(t){t?localStorage.setItem("github_token",t):localStorage.getItem("github_token")&&localStorage.removeItem("github_token")}},events:{"load-items":function(t){this.token?this.http.get("repos/"+this.config.username+"/"+this.config.repository+"/contents/"+(t.item?t.item.id:""),{headers:{Authorization:"token "+this.token}}).then(function(e){var n=e.data.map(function(t){return this.createItem({id:t.path.replace(/^\/+/,""),name:t.name,type:t.type,data:t})}.bind(this));t.items=n.sort(function(t,e){if("dir"===t.type&&"dir"!==e.type)return-1;if("dir"!==t.type&&"dir"===e.type)return 1;var n=t.name.toLowerCase(),i=e.name.toLowerCase();return n<i?-1:n>i?1:0})},function(){this.token=null,this.$dispatch("load-items",t)}.bind(this)):this.createToken().then(function(){this.$dispatch("load-items",t)}.bind(this))}},methods:{createToken:function(){return this.login(function(t,e,n){var i=document.location.protocol+"//"+document.location.host,o="netresearch-assetpicker-github-"+i,r={headers:{Authorization:"Basic "+btoa(t+":"+e)}},a=function(){this.http.post("authorizations",{note:"Repository access for "+this.t("header.title")+" at "+i,scopes:["public_repo","repo"],fingerprint:o},r).then(function(t){if(this.token=t.data.token,!this.token)throw"Could not find expected this.token";n(!0)}.bind(this))}.bind(this);this.http.get("authorizations",r).then(function(t){for(var e=0,n=t.data.length;e<n;e++)if(t.data[e].fingerprint===o)return void this.http["delete"]("authorizations/"+t.data[e].id,r).then(a);a()}.bind(this),function(){n(!1)})})}}}},{}]},{},[1])(1)});
//# sourceMappingURL=../maps/adapter/github.js.map
