!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.AssetPickerAdapterGithub=t()}}(function(){return function t(e,n,i){function o(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var f=n[s]={exports:{}};e[s][0].call(f.exports,function(t){var n=e[s][1][t];return o(n?n:t)},f,f.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){e.exports={translations:{description:{en:"Repository {{config.username}}/{{config.repository}} on GitHub",de:"Repository {{config.username}}/{{config.repository}} auf GitHub"}},http:{base:"https://api.github.com"},data:function(){return{token:null}},created:function(){this.token=this.appConfig.github.token||localStorage.getItem("github_token")},watch:{token:function(t){t?localStorage.setItem("github_token",t):localStorage.getItem("github_token")&&localStorage.removeItem("github_token")}},events:{"load-items":function(t){this.token?this.http.get("repos/"+this.config.username+"/"+this.config.repository+"/contents/"+(t.item?t.item.id:""),{headers:{Authorization:"token "+this.token}}).then(function(e){var n=e.data.map(function(t){return this.createItem({id:t.path.replace(/^\/+/,""),name:t.name,type:t.type,data:t,links:{open:t.html_url}})}.bind(this));t.items=this.sortItems(n)},function(){this.token=null,this.$dispatch("load-items",t)}.bind(this)):this.createToken().then(function(){this.$dispatch("load-items",t)}.bind(this))}},methods:{createToken:function(){return this.login(function(t,e,n){var i=document.location.protocol+"//"+document.location.host,o="netresearch-assetpicker-github-"+i,r={headers:{Authorization:"Basic "+btoa(t+":"+e)}},s=function(){this.http.post("authorizations",{note:"Repository access for "+this.t("header.title")+" at "+i,scopes:["public_repo","repo"],fingerprint:o},r).then(function(t){if(this.token=t.data.token,!this.token)throw"Could not find expected this.token";n(!0)}.bind(this))}.bind(this);this.http.get("authorizations",r).then(function(t){for(var e=0,n=t.data.length;e<n;e++)if(t.data[e].fingerprint===o)return void this.http["delete"]("authorizations/"+t.data[e].id,r).then(s);s()}.bind(this),function(){n(!1)})})}}}},{}]},{},[1])(1)});
//# sourceMappingURL=../maps/adapter/github.js.map
