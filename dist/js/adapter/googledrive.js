!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.AssetPickerAdapterGoogledrive=t()}}(function(){return function t(e,i,n){function o(a,r){if(!i[a]){if(!e[a]){var h="function"==typeof require&&require;if(!r&&h)return h(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var p=i[a]={exports:{}};e[a][0].call(p.exports,function(t){var i=e[a][1][t];return o(i?i:t)},p,p.exports,t,e,i,n)}return i[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,i){var n;e.exports={http:{base:"https://content.googleapis.com/drive/v3"},created:function(){this.auth&&(this.config.email=this.auth.email)},stored:{auth:!0},methods:{loadAuth2:function(){return this.$promise(function(t){n?t():this.util.loadScript("https://apis.google.com/js/platform.js",function(){gapi.load("auth2",function(){gapi.auth2.init({client_id:this.config.client_id,scope:"https://www.googleapis.com/auth/drive.readonly"}).then(function(e){n=e,t()})}.bind(this))}.bind(this))})},signIn:function(){return this.$promise(function(t){this.loadAuth2().then(function(){if(n.isSignedIn.get())t(n.currentUser.get());else{var e=this.$parent.open;this.$parent.open=!0;var i=this.$el.appendChild(document.createElement("div"));i.className="panel panel-default";var o=i.appendChild(document.createElement("div"));o.className="btn btn-default btn-block",o.innerHTML=this.t("login.login"),n.attachClickHandler(o,{},function(n){console.log(n.getAuthResponse()),this.$parent.open=e,this.$el.removeChild(i),t(n)}.bind(this))}}.bind(this))})},setupToken:function(){return this.$promise(function(t){var e=function(){this.$options.http.params={key:this.config.api_key},this.$options.http.headers={Authorization:"Bearer "+this.auth.token},t()}.bind(this);this.auth&&this.auth.expires_at<Date.now()&&(this.auth=null),this.auth?e():this.signIn().then(function(t){this.auth={token:t.getAuthResponse().access_token,expires_at:t.getAuthResponse().expires_at,email:t.getBasicProfile().getEmail()},e()}.bind(this))})},loadItems:function(){return this.$promise(function(t){this.setupToken().then(function(t){this.http.get("files",{params:{key:this.config.api_key,q:"'root' in parents"}})}.bind(this))})}},events:{"load-items":function(t){this.setupToken().then(function(e){this.http.get("files",{params:{key:this.config.api_key,q:"'"+(t.item?t.item.id:"root")+"' in parents"}}).then(function(e){console.log(e),t.items=JSON.parse(e.data).files.map(function(t){return this.createItem({id:t.id,name:t.name,type:"application/vnd.google-apps.folder"===t.mimeType?"dir":"file",data:t})}.bind(this)),console.log(t.items)})}.bind(this))}}}},{}]},{},[1])(1)});
//# sourceMappingURL=../maps/adapter/googledrive.js.map
