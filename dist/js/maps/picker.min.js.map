{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","node_modules/extend/index.js","picker.min.js","node_modules/insert-css/index.js","src/js/picker/components/modal/index.css","src/js/picker/components/modal/index.html","src/js/picker/components/modal/index.js","src/js/picker/index.js","src/js/shared/util/createClass.js","src/js/shared/util/messaging.js","src/js/shared/util/uid.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","hasOwn","Object","prototype","hasOwnProperty","toStr","toString","isArray","arr","Array","isPlainObject","obj","hasOwnConstructor","hasIsPrototypeOf","constructor","key","extend","options","name","src","copy","copyIsArray","clone","target","arguments","deep","2","createStyleElement","styleElement","document","createElement","setAttribute","containers","styleElements","css","position","prepend","container","undefined","querySelector","containerId","indexOf","push","insertBefore","childNodes","appendChild","styleSheet","cssText","textContent","3","4","5","insertCss","transitionEvent","el","transitions","transition","OTransition","MozTransition","WebkitTransition","style","hasTransitions","element","window","getComputedStyle","transitionDuration","hasTransition","filter","match","Messaging","construct","this","template","openClassName","messagingServer","modal","frame","matches","messaging","location","origin","render","div","innerHTML","children","addEventListener","event","close","bind","body","_modalClass","className","open","that","setTimeout","contentWindow","addClass","_closed","closeTransitionHandler","removeEventListener","removeClass","split","classNames","newClassNames","join","../../../shared/util/createClass","../../../shared/util/messaging","./index.css","./index.html","insert-css","6","Modal","uid","scriptURL","scripts","getElementsByTagName","AssetPicker","config","selector","slice","hostname","_memoryEvents","ready","_callbacks","on","maximize","_init","callback","apply","_trigger","args","forEach","registerServer","inputs","querySelectorAll","_initInput","preventDefault","limit","hasAttribute","parseInt","getAttribute","types","extensions","getConfig","pick","picked","targetSelector","inputName","stringified","JSON","stringify","area","innerText","escaped","targets","tagName","inputElement","parentNode","../shared/util/createClass","../shared/util/uid","./components/modal","7","protoProps","result","keys","8","windowObject","eventMethod","eventer","messageEvent","originalEvent","source","handle","data","servers","_handlers","object","_createHandler","handler","callbacks","then","_result","method","id","postMessage","message","methodPath","pop","shift","resolve","res","./createClass","./uid","9","Math","random","substr"],"mappings":"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","file":"picker.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) {/**/}\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone,\n\t\ttarget = arguments[0],\n\t\ti = 1,\n\t\tlength = arguments.length,\n\t\tdeep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t} else if ((typeof target !== 'object' && typeof target !== 'function') || target == null) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) {/**/}\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone,\n\t\ttarget = arguments[0],\n\t\ti = 1,\n\t\tlength = arguments.length,\n\t\tdeep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t} else if ((typeof target !== 'object' && typeof target !== 'function') || target == null) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n\n},{}],2:[function(require,module,exports){\nvar containers = []; // will store container HTMLElement references\nvar styleElements = []; // will store {prepend: HTMLElement, append: HTMLElement}\n\nmodule.exports = function (css, options) {\n    options = options || {};\n\n    var position = options.prepend === true ? 'prepend' : 'append';\n    var container = options.container !== undefined ? options.container : document.querySelector('head');\n    var containerId = containers.indexOf(container);\n\n    // first time we see this container, create the necessary entries\n    if (containerId === -1) {\n        containerId = containers.push(container) - 1;\n        styleElements[containerId] = {};\n    }\n\n    // try to get the correponding container + position styleElement, create it otherwise\n    var styleElement;\n\n    if (styleElements[containerId] !== undefined && styleElements[containerId][position] !== undefined) {\n        styleElement = styleElements[containerId][position];\n    } else {\n        styleElement = styleElements[containerId][position] = createStyleElement();\n\n        if (position === 'prepend') {\n            container.insertBefore(styleElement, container.childNodes[0]);\n        } else {\n            container.appendChild(styleElement);\n        }\n    }\n\n    // actually add the stylesheet\n    if (styleElement.styleSheet) {\n        styleElement.styleSheet.cssText += css\n    } else {\n        styleElement.textContent += css;\n    }\n\n    return styleElement;\n};\n\nfunction createStyleElement() {\n    var styleElement = document.createElement('style');\n    styleElement.setAttribute('type', 'text/css');\n    return styleElement;\n}\n\n},{}],3:[function(require,module,exports){\nmodule.exports = '.assetpicker-modal {\\n    position: fixed;\\n    top: 0;\\n    bottom: 0;\\n    left: 0;\\n    right: 0;\\n    background: rgba(0, 0, 0, 0);\\n    z-index: -1;\\n    transition: background 0.2s, z-index 0s 0.2s;\\n}\\n.assetpicker-modal.assetpicker-modal-open {\\n    z-index:3000;\\n    background: rgba(0, 0, 0, 0.8);\\n    transition: background 0.2s\\n}\\n.assetpicker-modal .assetpicker-modal-inner {\\n    position: absolute;\\n    background: #fff;\\n    width: 800px;\\n    height: 500px;\\n    max-width: calc(100% - 30px);\\n    max-height: calc(100% - 30px);\\n    left:50%;\\n    top:50%;\\n    transform: translateY(-50%) translateX(-50%);\\n    opacity: 0;\\n    transition: opacity 0.1s 0.1s;\\n    border-radius: 4px;\\n    overflow: hidden;\\n}\\n.assetpicker-modal.assetpicker-maximized .assetpicker-modal-inner {\\n    width: 100%;\\n    height: 100%;\\n}\\n.assetpicker-modal.assetpicker-modal-open .assetpicker-modal-inner {\\n    opacity: 1;\\n}\\n.assetpicker-modal .assetpicker-modal-inner iframe {\\n    position: absolute;\\n    background: transparent;\\n    top:0;\\n    left:0;\\n    width:100%;\\n    height: 100%;\\n    overflow: hidden;\\n    border: none;\\n}\\n\\n.assetpicker-loader {\\n    border: 5px solid gray;\\n    border-radius: 30px;\\n    height: 30px;\\n    left: 50%;\\n    margin: -15px 0 0 -15px;\\n    opacity: 0;\\n    position: absolute;\\n    top: 50%;\\n    width: 30px;\\n\\n    animation: assetpicker-loader-pulsate 1s ease-out;\\n    animation-iteration-count: infinite;\\n}\\n.assetpicker-ready .assetpicker-loader {\\n    display: none;\\n    animation: none;\\n}\\n\\n@keyframes assetpicker-loader-pulsate {\\n    0% {\\n        transform: scale(.1);\\n        opacity: 0.0;\\n    }\\n    50% {\\n        opacity: 1;\\n    }\\n    100% {\\n        transform: scale(1.2);\\n        opacity: 0;\\n    }\\n}';\n},{}],4:[function(require,module,exports){\nmodule.exports = '<div class=\"assetpicker-modal\">\\n    <div class=\"assetpicker-modal-inner\">\\n        <div class=\"assetpicker-loader\"></div>\\n        <iframe src=\"about:blank\" allowtransparency=\"true\">\\n            Ehm, without iframes i ain\\'t do nothing.\\n        </iframe>\\n    </div>\\n</div>\\n';\n},{}],5:[function(require,module,exports){\nvar extend = require('extend'),\n    insertCss = require('insert-css'),\n    transitionEvent = (function() {\n        var el = document.createElement('div');\n        var transitions = {\n            'transition': 'transitionend',\n            'OTransition': 'otransitionend',\n            'MozTransition': 'transitionend',\n            'WebkitTransition': 'webkitTransitionEnd'\n        };\n        for (var i in transitions) {\n            if (transitions.hasOwnProperty(i) && el.style[i] !== undefined) {\n                return transitions[i];\n            }\n        }\n    })(),\n    hasTransitions = function(element) {\n        var css = window.getComputedStyle(element, null);\n        var transitionDuration = ['transitionDuration', 'oTransitionDuration', 'MozTransitionDuration', 'webkitTransitionDuration'];\n        var hasTransition = transitionDuration.filter(function (i) {\n            if (typeof css[i] === 'string' && css[i].match(/[1-9]/)) {\n                return true;\n            }\n        });\n        return hasTransition.length ? true : false;\n    },\n    Messaging = require('../../../shared/util/messaging');\n\nmodule.exports = require('../../../shared/util/createClass')({\n    construct: function (options) {\n        this.options = extend(\n            {\n                template: require('./index.html'),\n                css: require('./index.css'),\n                openClassName: 'assetpicker-modal-open',\n                src: null,\n                messagingServer: null\n            },\n            options\n        );\n        this.modal = null;\n        this.frame = null;\n\n        var matches = this.options.src.match(/^https?:\\/\\/[^\\/]+/);\n        this.messaging = new Messaging(matches ? matches[0] : document.location.origin)\n    },\n    render: function() {\n        if (this.options.css) {\n            insertCss(this.options.css);\n        }\n        var div = document.createElement('div');\n        div.innerHTML = this.options.template;\n        this.modal = div.children[0];\n        this.modal.addEventListener('click', function(event) {\n            if (event.target === this.modal) {\n                this.close();\n            }\n        }.bind(this));\n        this.frame = this.modal.querySelector('iframe');\n        document.body.appendChild(this.modal);\n        this._modalClass = this.modal.className;\n    },\n    open: function() {\n        if (!this.modal) {\n            this.render();\n            var that = this;\n            this.frame.src = this.options.src;\n            window.setTimeout(function() { that.open(); }, 1);\n            return;\n        }\n        this.messaging.window = this.frame.contentWindow;\n        this.addClass(this.options.openClassName);\n    },\n    _closed: function() {\n    },\n    close: function() {\n        if (transitionEvent && hasTransitions(this.modal)) {\n            var closeTransitionHandler = function () {\n                this.modal.removeEventListener(transitionEvent, closeTransitionHandler);\n                this._closed();\n            }.bind(this);\n            this.modal.addEventListener(transitionEvent, closeTransitionHandler);\n        } else {\n            this._closed();\n        }\n        this.removeClass(this.options.openClassName);\n    },\n    addClass: function(className) {\n        if (this.modal.className.split(' ').indexOf(className) === -1) {\n            this.modal.className += ' ' + className;\n        }\n    },\n    removeClass: function(className) {\n        var classNames = this.modal.className.split(' '), newClassNames = [];\n        for (var i = 0, l = classNames.length; i < l; i++) {\n            if (classNames[i] !== className) {\n                newClassNames.push(classNames[i]);\n            }\n        }\n        this.modal.className = newClassNames.join(' ');\n    }\n});\n\n},{\"../../../shared/util/createClass\":7,\"../../../shared/util/messaging\":8,\"./index.css\":3,\"./index.html\":4,\"extend\":1,\"insert-css\":2}],6:[function(require,module,exports){\nvar Modal = require('./components/modal');\nvar uid = require('../shared/util/uid');\nvar extend = require('extend');\n\nvar scriptURL = (function() {\n    var scripts = document.getElementsByTagName('script');\n    return scripts[scripts.length - 1].src;\n})();\n\nwindow.AssetPicker = require('../shared/util/createClass')({\n    construct: function(config, options) {\n        options = extend(\n            true,\n            {\n                selector: '[rel=\"assetpicker\"]',\n                modal: {\n                    src: null\n                }\n            },\n            options || {}\n        );\n        if (!options.modal.src) {\n            options.modal.src = scriptURL.split('/').slice(0, -3).join('/') + '/';\n        }\n        if (options.modal.src.match(/^https?:\\/\\/localhost/) || document.location.hostname === 'localhost') {\n            options.modal.src += '?' + uid();\n        }\n\n        this.config = config || {};\n        this.options = options;\n        this.modal = null;\n        this.element = null;\n\n        this._memoryEvents = {\n            'ready': null\n        };\n        this._callbacks = {};\n\n        this.on('ready', function () {\n            this.modal.modal.className += ' assetpicker-ready'\n        });\n        this.on('resize', function (maximize) {\n            this.modal[maximize ? 'addClass' : 'removeClass']('assetpicker-maximized');\n        });\n\n        document.addEventListener('DOMContentLoaded', this._init.bind(this));\n    },\n    on: function (event, callback) {\n        if (!this._callbacks.hasOwnProperty(event)) {\n            this._callbacks[event] = [];\n        }\n        this._callbacks[event].push(callback);\n        if (this._memoryEvents[event]) {\n            callback.apply(this, this._memoryEvents[event]);\n        }\n        return this;\n    },\n    _trigger: function (event) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        if (this._callbacks[event]) {\n            this._callbacks[event].forEach(function (callback) {\n                return callback.apply(this, args);\n            }.bind(this));\n        }\n        if (this._memoryEvents.hasOwnProperty(event)) {\n            this._memoryEvents[event] = args;\n        }\n    },\n    _init: function() {\n        this.modal = new Modal(this.options.modal);\n        this.modal.messaging.registerServer('picker', this);\n        var inputs = document.querySelectorAll(this.options.selector);\n        for (var i = 0, l = inputs.length; i < l; i++) {\n            this._initInput(inputs[i]);\n        }\n    },\n    _initInput: function (element) {\n        element.addEventListener('click', function(event) {\n            event.preventDefault();\n            this.element = element;\n            this.modal.open();\n            this.on(\n                'app-ready',\n                function () {\n                    this.modal.messaging.call('app.setPickConfig', {\n                        limit: element.hasAttribute('data-limit') ? parseInt(element.getAttribute('data-limit')) : 1,\n                        types: element.hasAttribute('data-types') ? element.getAttribute('data-types').split(',') : ['file'],\n                        extensions: element.hasAttribute('data-ext') ? element.getAttribute('data-ext').split(',') : []\n                    })\n                }\n            );\n        }.bind(this));\n    },\n    getConfig: function() {\n        return this.config;\n    },\n    pick: function(picked) {\n        var targetSelector = this.element.getAttribute('data-target');\n        var inputName = this.element.getAttribute('data-name');\n        if (targetSelector || inputName) {\n            var stringified = JSON.stringify(picked);\n            if (targetSelector) {\n                var area = document.createElement('textarea');\n                area.innerText = stringified;\n                var escaped = area.innerHTML;\n                var targets = document.querySelectorAll(targetSelector);\n                for (var i = 0, l = targets.length; i < l; i++) {\n                    if (targets[i].tagName === 'input') {\n                        targets[i].setAttribute('value', stringified);\n                    } else {\n                        targets[i].innerHTML = escaped;\n                    }\n                }\n            }\n            if (inputName) {\n                var inputElement = document.createElement('input');\n                inputElement.setAttribute('type', 'hidden');\n                inputElement.setAttribute('name', inputName);\n                inputElement.setAttribute('value', stringified);\n                this.element.parentNode.insertBefore(inputElement, this.element);\n            }\n        }\n        this._trigger('pick', picked);\n        this.modal.close();\n    }\n});\n\n},{\"../shared/util/createClass\":7,\"../shared/util/uid\":9,\"./components/modal\":5,\"extend\":1}],7:[function(require,module,exports){\nmodule.exports = function(protoProps) {\n    var result = function () {\n        if (this.construct) {\n            this.construct.apply(this, arguments);\n        }\n    };\n\n    result.prototype = result;\n    Object.keys(protoProps).forEach(function(key) {\n        result.prototype[key] = protoProps[key];\n    });\n\n    return result;\n};\n\n},{}],8:[function(require,module,exports){\nvar uid = require('./uid');\n\nmodule.exports = require('./createClass')({\n    construct: function(origin, windowObject) {\n        var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\n        var eventer = window[eventMethod];\n        var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\n        eventer(messageEvent, function(e) {\n            var origin = e.origin || e.originalEvent.origin;\n            if (e.source === this.window && origin === this.origin || this.origin === '*') {\n                this.handle(e.data);\n            }\n        }.bind(this), false);\n\n        this.origin = origin;\n        this.window = windowObject;\n        this.servers = {};\n        this._handlers = {};\n    },\n    registerServer: function (name, object) {\n        this.servers[name] = object;\n    },\n    _createHandler: function() {\n        var handler = { callbacks: [] };\n        handler.then = function (callback) {\n            if (handler.hasOwnProperty('_result')) {\n                callback(handler._result);\n            } else {\n                handler.callbacks.push(callback);\n            }\n            return handler;\n        };\n        return handler;\n    },\n    call: function(method) {\n        var arguments = Array.prototype.slice.call(arguments, 1);\n        var id = uid(), handler = this._createHandler();\n        this._handlers[id] = handler;\n        this.window.postMessage({id: id, method: method, arguments: arguments}, this.origin);\n        return handler;\n    },\n    handle: function(message) {\n        if (message.method === 'resolve') {\n            if (this._handlers[message.id]) {\n                var handler = this._handlers[message.id];\n                for (var i = 0, l = handler.callbacks.length; i < l; i++) {\n                    handler.callbacks[i](message.result);\n                }\n                handler._result = message.result;\n                delete this._handlers[message.id];\n            }\n        } else {\n            var methodPath = message.method.split('.');\n            var method = methodPath.pop();\n            var target = this.servers;\n            while (target && methodPath.length) {\n                target = target[methodPath.shift()];\n            }\n            if (!target || !target[method]) {\n                throw 'Unknown method \"' + message.method + '\"';\n            }\n            var result = target[method].apply(target, message.arguments);\n            var resolve = function(res) {\n                // It might occure, that the id is reset, when the target frame is removed\n                if (message.id) {\n                    this.window.postMessage({method: 'resolve', id: message.id, result: res}, this.origin);\n                }\n            }.bind(this);\n            if (typeof result === 'function') {\n                result(resolve);\n            } else {\n                resolve(result);\n            }\n        }\n    }\n});\n\n},{\"./createClass\":7,\"./uid\":9}],9:[function(require,module,exports){\nmodule.exports = function uid () {\n    return '' + Math.random().toString(36).substr(2, 9);\n};\n\n},{}]},{},[6])\n\n","var containers = []; // will store container HTMLElement references\nvar styleElements = []; // will store {prepend: HTMLElement, append: HTMLElement}\n\nmodule.exports = function (css, options) {\n    options = options || {};\n\n    var position = options.prepend === true ? 'prepend' : 'append';\n    var container = options.container !== undefined ? options.container : document.querySelector('head');\n    var containerId = containers.indexOf(container);\n\n    // first time we see this container, create the necessary entries\n    if (containerId === -1) {\n        containerId = containers.push(container) - 1;\n        styleElements[containerId] = {};\n    }\n\n    // try to get the correponding container + position styleElement, create it otherwise\n    var styleElement;\n\n    if (styleElements[containerId] !== undefined && styleElements[containerId][position] !== undefined) {\n        styleElement = styleElements[containerId][position];\n    } else {\n        styleElement = styleElements[containerId][position] = createStyleElement();\n\n        if (position === 'prepend') {\n            container.insertBefore(styleElement, container.childNodes[0]);\n        } else {\n            container.appendChild(styleElement);\n        }\n    }\n\n    // actually add the stylesheet\n    if (styleElement.styleSheet) {\n        styleElement.styleSheet.cssText += css\n    } else {\n        styleElement.textContent += css;\n    }\n\n    return styleElement;\n};\n\nfunction createStyleElement() {\n    var styleElement = document.createElement('style');\n    styleElement.setAttribute('type', 'text/css');\n    return styleElement;\n}\n","module.exports = '.assetpicker-modal {\\n    position: fixed;\\n    top: 0;\\n    bottom: 0;\\n    left: 0;\\n    right: 0;\\n    background: rgba(0, 0, 0, 0);\\n    z-index: -1;\\n    transition: background 0.2s, z-index 0s 0.2s;\\n}\\n.assetpicker-modal.assetpicker-modal-open {\\n    z-index:3000;\\n    background: rgba(0, 0, 0, 0.8);\\n    transition: background 0.2s\\n}\\n.assetpicker-modal .assetpicker-modal-inner {\\n    position: absolute;\\n    background: #fff;\\n    width: 800px;\\n    height: 500px;\\n    max-width: calc(100% - 30px);\\n    max-height: calc(100% - 30px);\\n    left:50%;\\n    top:50%;\\n    transform: translateY(-50%) translateX(-50%);\\n    opacity: 0;\\n    transition: opacity 0.1s 0.1s;\\n    border-radius: 4px;\\n    overflow: hidden;\\n}\\n.assetpicker-modal.assetpicker-maximized .assetpicker-modal-inner {\\n    width: 100%;\\n    height: 100%;\\n}\\n.assetpicker-modal.assetpicker-modal-open .assetpicker-modal-inner {\\n    opacity: 1;\\n}\\n.assetpicker-modal .assetpicker-modal-inner iframe {\\n    position: absolute;\\n    background: transparent;\\n    top:0;\\n    left:0;\\n    width:100%;\\n    height: 100%;\\n    overflow: hidden;\\n    border: none;\\n}\\n\\n.assetpicker-loader {\\n    border: 5px solid gray;\\n    border-radius: 30px;\\n    height: 30px;\\n    left: 50%;\\n    margin: -15px 0 0 -15px;\\n    opacity: 0;\\n    position: absolute;\\n    top: 50%;\\n    width: 30px;\\n\\n    animation: assetpicker-loader-pulsate 1s ease-out;\\n    animation-iteration-count: infinite;\\n}\\n.assetpicker-ready .assetpicker-loader {\\n    display: none;\\n    animation: none;\\n}\\n\\n@keyframes assetpicker-loader-pulsate {\\n    0% {\\n        transform: scale(.1);\\n        opacity: 0.0;\\n    }\\n    50% {\\n        opacity: 1;\\n    }\\n    100% {\\n        transform: scale(1.2);\\n        opacity: 0;\\n    }\\n}';","module.exports = '<div class=\"assetpicker-modal\">\\n    <div class=\"assetpicker-modal-inner\">\\n        <div class=\"assetpicker-loader\"></div>\\n        <iframe src=\"about:blank\" allowtransparency=\"true\">\\n            Ehm, without iframes i ain\\'t do nothing.\\n        </iframe>\\n    </div>\\n</div>\\n';","var extend = require('extend'),\n    insertCss = require('insert-css'),\n    transitionEvent = (function() {\n        var el = document.createElement('div');\n        var transitions = {\n            'transition': 'transitionend',\n            'OTransition': 'otransitionend',\n            'MozTransition': 'transitionend',\n            'WebkitTransition': 'webkitTransitionEnd'\n        };\n        for (var i in transitions) {\n            if (transitions.hasOwnProperty(i) && el.style[i] !== undefined) {\n                return transitions[i];\n            }\n        }\n    })(),\n    hasTransitions = function(element) {\n        var css = window.getComputedStyle(element, null);\n        var transitionDuration = ['transitionDuration', 'oTransitionDuration', 'MozTransitionDuration', 'webkitTransitionDuration'];\n        var hasTransition = transitionDuration.filter(function (i) {\n            if (typeof css[i] === 'string' && css[i].match(/[1-9]/)) {\n                return true;\n            }\n        });\n        return hasTransition.length ? true : false;\n    },\n    Messaging = require('../../../shared/util/messaging');\n\nmodule.exports = require('../../../shared/util/createClass')({\n    construct: function (options) {\n        this.options = extend(\n            {\n                template: require('./index.html'),\n                css: require('./index.css'),\n                openClassName: 'assetpicker-modal-open',\n                src: null,\n                messagingServer: null\n            },\n            options\n        );\n        this.modal = null;\n        this.frame = null;\n\n        var matches = this.options.src.match(/^https?:\\/\\/[^\\/]+/);\n        this.messaging = new Messaging(matches ? matches[0] : document.location.origin)\n    },\n    render: function() {\n        if (this.options.css) {\n            insertCss(this.options.css);\n        }\n        var div = document.createElement('div');\n        div.innerHTML = this.options.template;\n        this.modal = div.children[0];\n        this.modal.addEventListener('click', function(event) {\n            if (event.target === this.modal) {\n                this.close();\n            }\n        }.bind(this));\n        this.frame = this.modal.querySelector('iframe');\n        document.body.appendChild(this.modal);\n        this._modalClass = this.modal.className;\n    },\n    open: function() {\n        if (!this.modal) {\n            this.render();\n            var that = this;\n            this.frame.src = this.options.src;\n            window.setTimeout(function() { that.open(); }, 1);\n            return;\n        }\n        this.messaging.window = this.frame.contentWindow;\n        this.addClass(this.options.openClassName);\n    },\n    _closed: function() {\n    },\n    close: function() {\n        if (transitionEvent && hasTransitions(this.modal)) {\n            var closeTransitionHandler = function () {\n                this.modal.removeEventListener(transitionEvent, closeTransitionHandler);\n                this._closed();\n            }.bind(this);\n            this.modal.addEventListener(transitionEvent, closeTransitionHandler);\n        } else {\n            this._closed();\n        }\n        this.removeClass(this.options.openClassName);\n    },\n    addClass: function(className) {\n        if (this.modal.className.split(' ').indexOf(className) === -1) {\n            this.modal.className += ' ' + className;\n        }\n    },\n    removeClass: function(className) {\n        var classNames = this.modal.className.split(' '), newClassNames = [];\n        for (var i = 0, l = classNames.length; i < l; i++) {\n            if (classNames[i] !== className) {\n                newClassNames.push(classNames[i]);\n            }\n        }\n        this.modal.className = newClassNames.join(' ');\n    }\n});\n","var Modal = require('./components/modal');\nvar uid = require('../shared/util/uid');\nvar extend = require('extend');\n\nvar scriptURL = (function() {\n    var scripts = document.getElementsByTagName('script');\n    return scripts[scripts.length - 1].src;\n})();\n\nwindow.AssetPicker = require('../shared/util/createClass')({\n    construct: function(config, options) {\n        options = extend(\n            true,\n            {\n                selector: '[rel=\"assetpicker\"]',\n                modal: {\n                    src: null\n                }\n            },\n            options || {}\n        );\n        if (!options.modal.src) {\n            options.modal.src = scriptURL.split('/').slice(0, -3).join('/') + '/';\n        }\n        if (options.modal.src.match(/^https?:\\/\\/localhost/) || document.location.hostname === 'localhost') {\n            options.modal.src += '?' + uid();\n        }\n\n        this.config = config || {};\n        this.options = options;\n        this.modal = null;\n        this.element = null;\n\n        this._memoryEvents = {\n            'ready': null\n        };\n        this._callbacks = {};\n\n        this.on('ready', function () {\n            this.modal.modal.className += ' assetpicker-ready'\n        });\n        this.on('resize', function (maximize) {\n            this.modal[maximize ? 'addClass' : 'removeClass']('assetpicker-maximized');\n        });\n\n        document.addEventListener('DOMContentLoaded', this._init.bind(this));\n    },\n    on: function (event, callback) {\n        if (!this._callbacks.hasOwnProperty(event)) {\n            this._callbacks[event] = [];\n        }\n        this._callbacks[event].push(callback);\n        if (this._memoryEvents[event]) {\n            callback.apply(this, this._memoryEvents[event]);\n        }\n        return this;\n    },\n    _trigger: function (event) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        if (this._callbacks[event]) {\n            this._callbacks[event].forEach(function (callback) {\n                return callback.apply(this, args);\n            }.bind(this));\n        }\n        if (this._memoryEvents.hasOwnProperty(event)) {\n            this._memoryEvents[event] = args;\n        }\n    },\n    _init: function() {\n        this.modal = new Modal(this.options.modal);\n        this.modal.messaging.registerServer('picker', this);\n        var inputs = document.querySelectorAll(this.options.selector);\n        for (var i = 0, l = inputs.length; i < l; i++) {\n            this._initInput(inputs[i]);\n        }\n    },\n    _initInput: function (element) {\n        element.addEventListener('click', function(event) {\n            event.preventDefault();\n            this.element = element;\n            this.modal.open();\n            this.on(\n                'app-ready',\n                function () {\n                    this.modal.messaging.call('app.setPickConfig', {\n                        limit: element.hasAttribute('data-limit') ? parseInt(element.getAttribute('data-limit')) : 1,\n                        types: element.hasAttribute('data-types') ? element.getAttribute('data-types').split(',') : ['file'],\n                        extensions: element.hasAttribute('data-ext') ? element.getAttribute('data-ext').split(',') : []\n                    })\n                }\n            );\n        }.bind(this));\n    },\n    getConfig: function() {\n        return this.config;\n    },\n    pick: function(picked) {\n        var targetSelector = this.element.getAttribute('data-target');\n        var inputName = this.element.getAttribute('data-name');\n        if (targetSelector || inputName) {\n            var stringified = JSON.stringify(picked);\n            if (targetSelector) {\n                var area = document.createElement('textarea');\n                area.innerText = stringified;\n                var escaped = area.innerHTML;\n                var targets = document.querySelectorAll(targetSelector);\n                for (var i = 0, l = targets.length; i < l; i++) {\n                    if (targets[i].tagName === 'input') {\n                        targets[i].setAttribute('value', stringified);\n                    } else {\n                        targets[i].innerHTML = escaped;\n                    }\n                }\n            }\n            if (inputName) {\n                var inputElement = document.createElement('input');\n                inputElement.setAttribute('type', 'hidden');\n                inputElement.setAttribute('name', inputName);\n                inputElement.setAttribute('value', stringified);\n                this.element.parentNode.insertBefore(inputElement, this.element);\n            }\n        }\n        this._trigger('pick', picked);\n        this.modal.close();\n    }\n});\n","module.exports = function(protoProps) {\n    var result = function () {\n        if (this.construct) {\n            this.construct.apply(this, arguments);\n        }\n    };\n\n    result.prototype = result;\n    Object.keys(protoProps).forEach(function(key) {\n        result.prototype[key] = protoProps[key];\n    });\n\n    return result;\n};\n","var uid = require('./uid');\n\nmodule.exports = require('./createClass')({\n    construct: function(origin, windowObject) {\n        var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\n        var eventer = window[eventMethod];\n        var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\n        eventer(messageEvent, function(e) {\n            var origin = e.origin || e.originalEvent.origin;\n            if (e.source === this.window && origin === this.origin || this.origin === '*') {\n                this.handle(e.data);\n            }\n        }.bind(this), false);\n\n        this.origin = origin;\n        this.window = windowObject;\n        this.servers = {};\n        this._handlers = {};\n    },\n    registerServer: function (name, object) {\n        this.servers[name] = object;\n    },\n    _createHandler: function() {\n        var handler = { callbacks: [] };\n        handler.then = function (callback) {\n            if (handler.hasOwnProperty('_result')) {\n                callback(handler._result);\n            } else {\n                handler.callbacks.push(callback);\n            }\n            return handler;\n        };\n        return handler;\n    },\n    call: function(method) {\n        var arguments = Array.prototype.slice.call(arguments, 1);\n        var id = uid(), handler = this._createHandler();\n        this._handlers[id] = handler;\n        this.window.postMessage({id: id, method: method, arguments: arguments}, this.origin);\n        return handler;\n    },\n    handle: function(message) {\n        if (message.method === 'resolve') {\n            if (this._handlers[message.id]) {\n                var handler = this._handlers[message.id];\n                for (var i = 0, l = handler.callbacks.length; i < l; i++) {\n                    handler.callbacks[i](message.result);\n                }\n                handler._result = message.result;\n                delete this._handlers[message.id];\n            }\n        } else {\n            var methodPath = message.method.split('.');\n            var method = methodPath.pop();\n            var target = this.servers;\n            while (target && methodPath.length) {\n                target = target[methodPath.shift()];\n            }\n            if (!target || !target[method]) {\n                throw 'Unknown method \"' + message.method + '\"';\n            }\n            var result = target[method].apply(target, message.arguments);\n            var resolve = function(res) {\n                // It might occure, that the id is reset, when the target frame is removed\n                if (message.id) {\n                    this.window.postMessage({method: 'resolve', id: message.id, result: res}, this.origin);\n                }\n            }.bind(this);\n            if (typeof result === 'function') {\n                result(resolve);\n            } else {\n                resolve(result);\n            }\n        }\n    }\n});\n","module.exports = function uid () {\n    return '' + Math.random().toString(36).substr(2, 9);\n};\n"],"sourceRoot":"/source/"}