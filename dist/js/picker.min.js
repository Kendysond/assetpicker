!function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[s]={exports:{}};e[s][0].call(d.exports,function(t){var n=e[s][1][t];return r(n?n:t)},d,d.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===r.call(t)},s=function(t){if(!t||"[object Object]"!==r.call(t))return!1;var e=i.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&i.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!n)return!1;var o;for(o in t);return"undefined"==typeof o||i.call(t,o)};e.exports=function a(){var t,e,n,i,r,c,l=arguments[0],d=1,u=arguments.length,h=!1;for("boolean"==typeof l?(h=l,l=arguments[1]||{},d=2):("object"!=typeof l&&"function"!=typeof l||null==l)&&(l={});d<u;++d)if(t=arguments[d],null!=t)for(e in t)n=l[e],i=t[e],l!==i&&(h&&i&&(s(i)||(r=o(i)))?(r?(r=!1,c=n&&o(n)?n:[]):c=n&&s(n)?n:{},l[e]=a(h,c,i)):"undefined"!=typeof i&&(l[e]=i));return l}},{}],2:[function(t,e,n){function i(){var t=document.createElement("style");return t.setAttribute("type","text/css"),t}var r=[],o=[];e.exports=function(t,e){e=e||{};var n=e.prepend===!0?"prepend":"append",s=void 0!==e.container?e.container:document.querySelector("head"),a=r.indexOf(s);a===-1&&(a=r.push(s)-1,o[a]={});var c;return void 0!==o[a]&&void 0!==o[a][n]?c=o[a][n]:(c=o[a][n]=i(),"prepend"===n?s.insertBefore(c,s.childNodes[0]):s.appendChild(c)),c.styleSheet?c.styleSheet.cssText+=t:c.textContent+=t,c}},{}],3:[function(t,e,n){e.exports=".assetpicker-modal {\n    position: fixed;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background: rgba(0, 0, 0, 0);\n    z-index: -1;\n    transition: background 0.2s, z-index 0s 0.2s;\n}\n.assetpicker-modal.assetpicker-modal-open {\n    z-index:3000;\n    background: rgba(0, 0, 0, 0.8);\n    transition: background 0.2s\n}\n.assetpicker-modal .assetpicker-modal-inner {\n    position: absolute;\n    left:30px;\n    right:30px;\n    top:30px;\n    bottom:30px;\n    background: #fff;\n    opacity: 0;\n    transition: opacity 0.1s 0.1s;\n    border-radius: 4px;\n    overflow: hidden;\n}\n.assetpicker-modal.assetpicker-modal-open .assetpicker-modal-inner {\n    opacity: 1;\n}\n.assetpicker-modal .assetpicker-modal-inner iframe {\n    position: absolute;\n    width:100%;\n    height: 100%;\n    overflow: hidden;\n    border: none;\n}\n"},{}],4:[function(t,e,n){e.exports='<div class="assetpicker-modal">\n    <div class="assetpicker-modal-inner">\n        <iframe src="about:blank">\n            Ehm, without iframes i ain\'t do nothing.\n        </iframe>\n    </div>\n</div>\n'},{}],5:[function(t,e,n){var i=t("extend"),r=t("insert-css"),o=function(t,e){t.className.split(" ").indexOf(e)===-1&&(t.className+=" "+e)},s=function(t,e){for(var n=t.className.split(" "),i=[],r=0,o=n.length;r<o;r++)n[r]!==e&&i.push(n[r]);t.className=i.join(" ")},a=function(){var t=document.createElement("div"),e={transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var n in e)if(e.hasOwnProperty(n)&&void 0!==t.style[n])return e[n]}(),c=function(t){var e=window.getComputedStyle(t,null),n=["transitionDuration","oTransitionDuration","MozTransitionDuration","webkitTransitionDuration"],i=n.filter(function(t){if("string"==typeof e[t]&&e[t].match(/[1-9]/))return!0});return!!i.length},l=t("../../../shared/util/messaging");e.exports=t("../../../shared/util/createClass")({construct:function(e){this.options=i({template:t("./index.html"),css:t("./index.css"),openClassName:"assetpicker-modal-open",src:null,messagingServer:null},e),this.modal=null,this.frame=null;var n=this.options.src.match(/^https?:\/\/[^\/]+/);this.messaging=new l(n?n[0]:document.location.origin)},render:function(){this.options.css&&r(this.options.css);var t=document.createElement("div");t.innerHTML=this.options.template,this.modal=t.children[0],this.modal.addEventListener("click",function(t){t.target===this.modal&&this.close()}.bind(this)),this.frame=this.modal.querySelector("iframe"),document.body.appendChild(this.modal),this._modalClass=this.modal.className},open:function(){if(!this.modal){this.render();var t=this;return void window.setTimeout(function(){t.open()},1)}this.frame.src=this.options.src,this.messaging.window=this.frame.contentWindow,o(this.modal,this.options.openClassName)},_closed:function(){this.frame.src="about:blank"},close:function(){if(a&&c(this.modal)){var t=function(){this.modal.removeEventListener(a,t),this._closed()}.bind(this);this.modal.addEventListener(a,t)}else this._closed();s(this.modal,this.options.openClassName)}})},{"../../../shared/util/createClass":7,"../../../shared/util/messaging":8,"./index.css":3,"./index.html":4,extend:1,"insert-css":2}],6:[function(t,e,n){var i=t("./components/modal"),r=t("../shared/util/uid"),o=t("extend"),s=function(){var t=document.getElementsByTagName("script");return t[t.length-1].src}();window.AssetPicker=t("../shared/util/createClass")({construct:function(t){t=o(!0,{picker:{selector:'[rel="assetpicker"]',modal:{src:null}}},t||{}),t.picker.modal.src||(t.picker.modal.src=s.split("/").slice(0,-3).join("/")+"/"),(t.picker.modal.src.match(/^https?:\/\/localhost/)||"localhost"===document.location.hostname)&&(t.picker.modal.src+="?"+r()),this.options=t,this.modal=null,this.element=null,this._onPickedCallback=null,document.addEventListener("DOMContentLoaded",this.init.bind(this))},init:function(){this.modal=new i(this.options.picker.modal),this.modal.messaging.registerServer("picker",this),document.querySelectorAll(this.options.picker.selector).forEach(this.initInput.bind(this))},initInput:function(t){t.addEventListener("click",function(e){e.preventDefault(),this.element=t,this.modal.open()}.bind(this))},getConfig:function(){return this.options},onPicked:function(t){this._onPickedCallback=t},picked:function(t){var e=this.element.getAttribute("data-target"),n=this.element.getAttribute("data-name");if(e||n){var i=JSON.stringify(t);if(e){var r=document.createElement("textarea");r.innerText=i;var o=r.innerHTML;document.querySelectorAll(e).forEach(function(t){"input"===t.tagName?t.setAttribute("value",i):t.innerHTML=o})}if(n){var s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name",n),s.setAttribute("value",i),this.element.parentNode.insertBefore(s,this.element)}}this._onPickedCallback&&this._onPickedCallback(t,this),this.modal.close()}})},{"../shared/util/createClass":7,"../shared/util/uid":9,"./components/modal":5,extend:1}],7:[function(t,e,n){e.exports=function(t){var e=function(){this.construct&&this.construct.apply(this,arguments)};return e.prototype=e,Object.keys(t).forEach(function(n){e.prototype[n]=t[n]}),e}},{}],8:[function(t,e,n){var i=t("./uid");e.exports=t("./createClass")({construct:function(t,e){var n=window.addEventListener?"addEventListener":"attachEvent",i=window[n],r="attachEvent"==n?"onmessage":"message";i(r,function(t){var e=t.origin||t.originalEvent.origin;e!==this.origin&&"*"!==this.origin||this.handle(t.data)}.bind(this),!1),this.origin=t,this.window=e,this.servers={},this._handlers={}},registerServer:function(t,e){this.servers[t]=e},_createHandler:function(){var t={callbacks:[]};return t.then=function(e){return t.hasOwnProperty("_result")?e(t._result):t.callbacks.push(e),t},t},call:function(t){var arguments=Array.prototype.slice.call(arguments,1),e=i(),n=this._createHandler();return this._handlers[e]=n,this.window.postMessage({id:e,method:t,arguments:arguments},this.origin),n},handle:function(t){if("resolve"===t.method){if(this._handlers[t.id]){for(var e=this._handlers[t.id],n=0,i=e.callbacks.length;n<i;n++)e.callbacks[n](t.result);e._result=t.result,delete this._handlers[t.id]}}else{for(var r=t.method.split("."),o=r.pop(),s=this.servers;s&&r.length;)s=s[r.shift()];if(!s||!s[o])throw'Unknown method "'+t.method+'"';var a=s[o].apply(s,t.arguments),c=function(e){t.id&&this.window.postMessage({method:"resolve",id:t.id,result:e},this.origin)}.bind(this);"function"==typeof a?a(c):c(a)}}})},{"./createClass":7,"./uid":9}],9:[function(t,e,n){e.exports=function(){return""+Math.random().toString(36).substr(2,9)}},{}]},{},[6]);
//# sourceMappingURL=maps/picker.min.js.map
